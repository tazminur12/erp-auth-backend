â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  LOAN RECEIVING - Repayment Guide (à¦¬à¦¾à¦‚à¦²à¦¾à¦¯à¦¼)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Loan Receiving à¦®à¦¾à¦¨à§‡: à¦†à¦®à¦°à¦¾ loan à¦¨à¦¿à¦¯à¦¼à§‡à¦›à¦¿
à¦à¦–à¦¨ à¦¸à§‡à¦‡ loan à¦«à§‡à¦°à¦¤ à¦¦à¦¿à¦¤à§‡ à¦¹à¦¬à§‡ (Repayment)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. LOAN RECEIVING PROCESS (à¦¯à¦¾ à¦†à¦—à§‡ à¦¹à¦¯à¦¼à§‡ à¦—à§‡à¦›à§‡)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Loan Application (Done) âœ…
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   POST /loans/receiving
   â†’ Status: 'Pending'
   â†’ Transaction create à¦¹à¦¯à¦¼ à¦¨à¦¾

STEP 2: Loan Approval (Done) âœ…
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   PATCH /loans/:loanId/approve
   {
     "targetAccountId": "account_id"  // à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à§‹à¦¨ account à¦ money credit à¦¹à¦¬à§‡
   }

   â†’ Status: 'Active'
   â†’ Transaction: CREDIT (à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦ money à¦à¦¸à§‡à¦›à§‡)
   â†’ Loan Amount: 50,000 à¦Ÿà¦¾à¦•à¦¾
   â†’ Remaining Amount: 50,000 à¦Ÿà¦¾à¦•à¦¾


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. LOAN REPAYMENT PROCESS (à¦à¦–à¦¨ à¦à¦‡ process)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 3: Loan à¦«à§‡à¦°à¦¤ à¦¦à§‡à¦“à¦¯à¦¼à¦¾ (Repayment) ğŸ’°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Endpoint: POST /loans/:loanId/repayment

âœ… Request Body:
   {
     "amount": 10000,              // à¦•à¦¤ à¦Ÿà¦¾à¦•à¦¾ à¦«à§‡à¦°à¦¤ à¦¦à¦¿à¦šà§à¦›à¦¿
     "repaymentDate": "2024-01-15", // Repayment date
     "paymentMethod": "bank-transfer",
     "sourceAccountId": "account_id",  // à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à§‹à¦¨ account à¦¥à§‡à¦•à§‡ money debit à¦¹à¦¬à§‡
     "notes": "First repayment installment",
     "createdBy": "user@email.com",
     "branchId": "main"
   }

âœ… à¦¯à¦¾ à¦¯à¦¾ à¦¹à¦¬à§‡ (Automatic):
   1. Transaction create à¦¹à¦¬à§‡ (DEBIT - à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦¥à§‡à¦•à§‡ money à¦¬à§‡à¦° à¦¹à¦šà§à¦›à§‡)
   2. Loan remainingAmount decrease à¦¹à¦¬à§‡ (50,000 - 10,000 = 40,000)
   3. Bank account balance decrease à¦¹à¦¬à§‡
   4. Payment history record à¦¹à¦¬à§‡
   5. Fully repaid à¦¹à¦²à§‡ loan status 'Closed' à¦¹à¦¬à§‡


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. COMPLETE FLOW EXAMPLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCENARIO: à¦†à¦®à¦°à¦¾ 50,000 à¦Ÿà¦¾à¦•à¦¾ loan à¦¨à¦¿à¦¯à¦¼à§‡à¦›à¦¿
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

DAY 1: Loan Approval
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   Loan Amount: 50,000 à¦Ÿà¦¾à¦•à¦¾
   Status: Active
   Remaining: 50,000 à¦Ÿà¦¾à¦•à¦¾
   Transaction: CREDIT 50,000 (à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦ à¦à¦¸à§‡à¦›à§‡)
   â†’ à¦†à¦®à¦¾à¦¦à§‡à¦° account balance: +50,000 à¦Ÿà¦¾à¦•à¦¾

DAY 30: Loan à¦«à§‡à¦°à¦¤ à¦¦à¦¿à¦²à¦¾à¦® 10,000 à¦Ÿà¦¾à¦•à¦¾
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   POST /loans/LOANRDH2508290001/repayment
   {
     "amount": 10000,
     "sourceAccountId": "our_account_id",  // à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦¥à§‡à¦•à§‡ debit
     "repaymentDate": "2024-01-30"
   }

   â†’ Transaction: DEBIT 10,000 (à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦¥à§‡à¦•à§‡ à¦¬à§‡à¦° à¦¹à¦¯à¦¼à§‡à¦›à§‡)
   â†’ Remaining: 50,000 - 10,000 = 40,000 à¦Ÿà¦¾à¦•à¦¾
   â†’ à¦†à¦®à¦¾à¦¦à§‡à¦° account balance: -10,000 à¦Ÿà¦¾à¦•à¦¾
   â†’ Status: Active (still)

DAY 60: à¦†à¦°à¦“ 10,000 à¦Ÿà¦¾à¦•à¦¾ à¦«à§‡à¦°à¦¤ à¦¦à¦¿à¦²à¦¾à¦®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   POST /loans/LOANRDH2508290001/repayment
   {
     "amount": 10000,
     "sourceAccountId": "our_account_id"
   }

   â†’ Transaction: DEBIT 10,000
   â†’ Remaining: 40,000 - 10,000 = 30,000 à¦Ÿà¦¾à¦•à¦¾
   â†’ Status: Active (still)

DAY 90: Balance 30,000 à¦Ÿà¦¾à¦•à¦¾ à¦«à§‡à¦°à¦¤ à¦¦à¦¿à¦²à¦¾à¦® (fully repaid)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   POST /loans/LOANRDH2508290001/repayment
   {
     "amount": 30000,
     "sourceAccountId": "our_account_id"
   }

   â†’ Transaction: DEBIT 30,000
   â†’ Remaining: 30,000 - 30,000 = 0 à¦Ÿà¦¾à¦•à¦¾
   â†’ Status: Closed (fully repaid) âœ…
   â†’ closedDate: 2024-03-30


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. FRONTEND IMPLEMENTATION (à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‡à¦¨)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LOAN REPAYMENT FORM:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

```javascript
const LoanRepaymentForm = ({ loanId, loanData, onRepaymentSuccess }) => {
  const [repaymentData, setRepaymentData] = useState({
    amount: '',
    repaymentDate: new Date().toISOString().split('T')[0],
    paymentMethod: 'bank-transfer',
    sourceAccountId: '',  // à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à§‹à¦¨ account à¦¥à§‡à¦•à§‡ money debit à¦¹à¦¬à§‡
    notes: ''
  });

  const handleRepaymentSubmit = async (e) => {
    e.preventDefault();

    // Validation
    if (!repaymentData.amount || !repaymentData.sourceAccountId) {
      Swal.fire({
        title: 'Error!',
        text: 'Amount and Source Account are required',
        icon: 'error'
      });
      return;
    }

    const repaymentAmount = parseFloat(repaymentData.amount);
    const remainingAmount = parseFloat(loanData.remainingAmount || loanData.amount);

    // Check if repayment exceeds remaining
    if (repaymentAmount > remainingAmount) {
      Swal.fire({
        title: 'Error!',
        text: `Repayment amount (${repaymentAmount}) exceeds remaining amount (${remainingAmount})`,
        icon: 'error'
      });
      return;
    }

    try {
      const response = await axiosSecure.post(
        `/loans/${loanId}/repayment`,
        {
          amount: repaymentAmount,
          repaymentDate: repaymentData.repaymentDate,
          paymentMethod: repaymentData.paymentMethod,
          sourceAccountId: repaymentData.sourceAccountId,  // à¦†à¦®à¦¾à¦¦à§‡à¦° account
          notes: repaymentData.notes,
          createdBy: userProfile?.email,
          branchId: userProfile?.branchId
        }
      );

      if (response.data.success) {
        if (response.data.repayment.isFullyRepaid) {
          Swal.fire({
            title: 'Loan Fully Repaid! ğŸ‰',
            text: 'The loan has been fully repaid.',
            icon: 'success',
            confirmButtonColor: '#10B981'
          });
        } else {
          Swal.fire({
            title: 'Repayment Recorded! âœ…',
            text: `Remaining amount: ${response.data.loan.remainingAmount} à¦Ÿà¦¾à¦•à¦¾`,
            icon: 'success',
            confirmButtonColor: '#10B981'
          });
        }

        // Callback to refresh loan data
        if (onRepaymentSuccess) {
          onRepaymentSuccess(response.data);
        }
      }
    } catch (error) {
      Swal.fire({
        title: 'Error!',
        text: error.response?.data?.message || 'Repayment failed',
        icon: 'error',
        confirmButtonColor: '#EF4444'
      });
    }
  };

  return (
    <form onSubmit={handleRepaymentSubmit}>
      {/* Repayment Amount */}
      <div>
        <label>Repayment Amount *</label>
        <input
          type="number"
          name="amount"
          value={repaymentData.amount}
          onChange={(e) => setRepaymentData({...repaymentData, amount: e.target.value})}
          placeholder={`Remaining: ${loanData.remainingAmount || loanData.amount} à¦Ÿà¦¾à¦•à¦¾`}
          max={loanData.remainingAmount || loanData.amount}
          required
        />
      </div>

      {/* Repayment Date */}
      <div>
        <label>Repayment Date *</label>
        <input
          type="date"
          name="repaymentDate"
          value={repaymentData.repaymentDate}
          onChange={(e) => setRepaymentData({...repaymentData, repaymentDate: e.target.value})}
          required
        />
      </div>

      {/* Source Bank Account (à¦†à¦®à¦¾à¦¦à§‡à¦° account - money à¦à¦‡à¦–à¦¾à¦¨ à¦¥à§‡à¦•à§‡ debit à¦¹à¦¬à§‡) */}
      <div>
        <label>Source Account (Our Account) *</label>
        <select
          name="sourceAccountId"
          value={repaymentData.sourceAccountId}
          onChange={(e) => setRepaymentData({...repaymentData, sourceAccountId: e.target.value})}
          required
        >
          <option value="">Select Source Account</option>
          {bankAccounts
            .filter(acc => acc.status === 'Active' && !acc.isDeleted)
            .map(account => (
              <option key={account._id} value={account._id}>
                {account.bankName} - {account.accountNumber} 
                (Balance: {account.currentBalance} {account.currency})
              </option>
            ))
          }
        </select>
        <p className="text-sm text-gray-500">
          Money à¦à¦‡ account à¦¥à§‡à¦•à§‡ debit à¦¹à¦¬à§‡
        </p>
      </div>

      {/* Payment Method */}
      <div>
        <label>Payment Method *</label>
        <select
          name="paymentMethod"
          value={repaymentData.paymentMethod}
          onChange={(e) => setRepaymentData({...repaymentData, paymentMethod: e.target.value})}
          required
        >
          <option value="bank-transfer">Bank Transfer</option>
          <option value="cash">Cash</option>
          <option value="check">Check</option>
          <option value="mobile-banking">Mobile Banking</option>
        </select>
      </div>

      {/* Notes */}
      <div>
        <label>Notes</label>
        <textarea
          name="notes"
          value={repaymentData.notes}
          onChange={(e) => setRepaymentData({...repaymentData, notes: e.target.value})}
          placeholder="Repayment notes (optional)"
        />
      </div>

      {/* Submit Button */}
      <button type="submit">
        Record Repayment
      </button>
    </form>
  );
};
```


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. IMPORTANT DIFFERENCES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LOAN GIVING - Payment (Borrower Payment):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   Endpoint: POST /loans/:loanId/payment
   Transaction Type: CREDIT (à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦ money à¦†à¦¸à¦›à§‡)
   Account Field: targetAccountId (à¦•à§‹à¦¨ account à¦ credit à¦¹à¦¬à§‡)
   - Borrower à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à¦¾à¦›à§‡ payment à¦¦à¦¿à¦šà§à¦›à§‡

LOAN RECEIVING - Repayment (à¦†à¦®à¦°à¦¾ Loan à¦«à§‡à¦°à¦¤ à¦¦à¦¿à¦šà§à¦›à¦¿):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   Endpoint: POST /loans/:loanId/repayment
   Transaction Type: DEBIT (à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦¥à§‡à¦•à§‡ money à¦¬à§‡à¦° à¦¹à¦šà§à¦›à§‡)
   Account Field: sourceAccountId (à¦•à§‹à¦¨ account à¦¥à§‡à¦•à§‡ debit à¦¹à¦¬à§‡)
   - à¦†à¦®à¦°à¦¾ loan à¦«à§‡à¦°à¦¤ à¦¦à¦¿à¦šà§à¦›à¦¿
   - à¦†à¦®à¦¾à¦¦à§‡à¦° account balance check à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡ (sufficient balance)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6. SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LOAN RECEIVING REPAYMENT FLOW:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Loan Approval â†’ POST /loans/:loanId/approve
   â†’ Status: Active
   â†’ Transaction: CREDIT (à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦ money à¦à¦¸à§‡à¦›à§‡)
   â†’ Remaining: 50,000 à¦Ÿà¦¾à¦•à¦¾

2. Loan Repayment â†’ POST /loans/:loanId/repayment
   â†’ Transaction: DEBIT (à¦†à¦®à¦¾à¦¦à§‡à¦° account à¦¥à§‡à¦•à§‡ money à¦¬à§‡à¦° à¦¹à¦šà§à¦›à§‡)
   â†’ Remaining: 40,000 à¦Ÿà¦¾à¦•à¦¾ (decrease)
   â†’ Status: Active

3. Fully Repaid â†’ POST /loans/:loanId/repayment
   â†’ Transaction: DEBIT
   â†’ Remaining: 0 à¦Ÿà¦¾à¦•à¦¾
   â†’ Status: Closed âœ…


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

à¦à¦‡ process follow à¦•à¦°à¦²à§‡ Loan Receiving à¦à¦° repayment à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ track à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨! ğŸ¯

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

